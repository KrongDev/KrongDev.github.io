# 데이터 구조 변경 가이드

## 📋 변경 개요

블로그 데이터 구조를 `posts.json` 단일 파일에서 **마크다운 파일 직접 로딩** 방식으로 변경했습니다.

### 주요 변경사항

1. **마크다운 파일 직접 로딩**: `_posts/` 폴더의 `.md` 파일을 직접 읽어서 사용
2. **카테고리 분리 관리**: 별도의 `categories.json` 파일로 카테고리 정보 관리
3. **메타데이터 경량화**: 목록 페이지에서는 메타데이터만 로드 (성능 최적화)

---

## 🗂️ 새로운 데이터 구조

### 1. 파일 구조

```
public/
├── data/
│   ├── posts-meta.json      # 포스트 메타데이터만 (목록용)
│   └── categories.json       # 카테고리 정보 (아이콘, 설명 포함)
└── _posts/
    ├── 2025-10-09-java-step1.md
    ├── 2025-10-10-kafka-event-streaming.md
    └── ... (모든 마크다운 파일)
```

### 2. posts-meta.json

**경량화된 메타데이터만 포함** (본문 제외)

```json
[
  {
    "id": "2025-10-09-java-step1",
    "slug": "2025-10-09-java-step1",
    "filename": "2025-10-09-java-step1.md",
    "title": "Java 기초 다지기",
    "date": "2025-10-09",
    "category": "Language",
    "subcategory": "Java",
    "tags": ["Java", "기초", "환경설정"],
    "excerpt": "Java 언어의 기초와 환경에 대해 학습합니다.",
    "author": "Geon Lee"
  }
]
```

### 3. categories.json

**아이콘, 설명, 통계 포함**

```json
[
  {
    "id": "Language",
    "name": "Programming Language",
    "icon": "📝",
    "description": "프로그래밍 언어",
    "count": 4,
    "subcategories": [
      {
        "id": "Java",
        "name": "Java",
        "count": 2
      }
    ]
  }
]
```

---

## 🔧 카테고리 설정 방법

### 빌드 스크립트에서 정의 (`scripts/build-posts.js`)

```javascript
const CATEGORY_CONFIG = [
  { 
    id: 'CS', 
    name: 'Computer Science', 
    icon: '💻', 
    description: '컴퓨터 과학 기초' 
  },
  { 
    id: 'Language', 
    name: 'Programming Language', 
    icon: '📝', 
    description: '프로그래밍 언어' 
  },
  { 
    id: 'Framework', 
    name: 'Framework', 
    icon: '🚀', 
    description: '프레임워크 & 라이브러리' 
  },
  { 
    id: 'Database', 
    name: 'Database', 
    icon: '🗄️', 
    description: '데이터베이스' 
  },
  { 
    id: 'Platform', 
    name: 'Platform', 
    icon: '☁️', 
    description: '플랫폼 & 인프라' 
  },
  { 
    id: 'Life', 
    name: 'Life', 
    icon: '🌱', 
    description: '개발 일상' 
  },
];
```

**카테고리 추가/수정 방법:**
1. `CATEGORY_CONFIG` 배열에 새 카테고리 추가
2. `npm run build:posts` 실행
3. `categories.json` 자동 생성

---

## 💡 데이터 로딩 방식

### 목록 페이지 (BlogList)

```typescript
// posts-meta.json만 로드 (가벼움)
const posts = await loadPosts();
// content, rawContent는 비어있음 (메타데이터만)
```

### 상세 페이지 (BlogDetail)

```typescript
// 마크다운 파일을 동적으로 로드 & 파싱
const post = await getPostById(id);
// /_posts/{filename}.md 파일을 fetch하여 HTML로 변환
```

---

## 🚀 장점

### 1. **성능 최적화**
- 목록 페이지: 메타데이터만 로드 (빠름)
- 상세 페이지: 필요한 포스트만 로드

### 2. **유연성**
- 마크다운 원본 파일 직접 접근
- 프론트엔드에서 동적 파싱 가능

### 3. **관리 편의성**
- 카테고리 설정을 중앙에서 관리
- 아이콘, 설명 등 메타 정보 추가 용이

### 4. **빌드 크기 감소**
- 중복 데이터 제거 (HTML 변환은 프론트엔드에서)
- 메타데이터 파일이 훨씬 가벼움

---

## 📝 포스트 작성 방법 (변경 없음)

```markdown
---
title: "포스트 제목"
date: "2025-10-09"
category: "Language"
subcategory: "Java"
tags: ["Java", "기초"]
excerpt: "짧은 요약"
author: "Geon Lee"
---

# 본문 내용
```

1. `_posts/` 폴더에 `.md` 파일 생성
2. Front Matter 작성
3. `npm run build:posts` 실행
4. 자동으로 `posts-meta.json`, `categories.json`, `public/_posts/` 생성

---

## 🔄 마이그레이션 완료

### 삭제된 파일
- ~~`public/data/posts.json`~~ (더 이상 사용 안 함)

### 새로 생성된 파일
- ✅ `public/data/posts-meta.json`
- ✅ `public/data/categories.json`
- ✅ `public/_posts/*.md` (복사본)

### 수정된 파일
- ✅ `scripts/build-posts.js` (새 구조로 빌드)
- ✅ `src/data/posts.ts` (마크다운 파일 동적 로딩)
- ✅ `src/types/post.ts` (filename, icon, description 추가)
- ✅ `src/components/LeftSidebar.tsx` (카테고리 아이콘 표시)

---

## 🎯 사용 방법

### 개발 모드 실행
```bash
npm run dev
```

### 빌드
```bash
npm run build
```

### 포스트만 빌드
```bash
npm run build:posts
```

---

## 📊 빌드 결과 예시

```bash
📝 Building posts...
✅ Built 13 post(s)
📁 Posts metadata: /path/to/posts-meta.json
📁 Markdown files copied to: /path/to/_posts

📊 Building categories...
✅ Built categories
📁 Categories: /path/to/categories.json
   💻 Computer Science: 2 posts
      └─ Algorithm: 1 posts
      └─ Structure: 1 posts
   📝 Programming Language: 4 posts
      └─ Java: 2 posts
      └─ Python: 1 posts
      └─ TypeScript: 1 posts
   🗄️ Database: 3 posts
      └─ MongoDB: 1 posts
      └─ MySQL: 1 posts
      └─ Redis: 1 posts
```

---

## 🎨 UI 개선

### 카테고리 아이콘
- 각 카테고리에 이모지 아이콘 표시
- 마우스 오버시 설명 툴팁

### 계층 구조
- 메인 카테고리 + 서브카테고리
- 접기/펼치기 기능

---

## 🔍 검색 기능

변경 없음. 마크다운 원본 텍스트에서 검색 수행.

```typescript
// rawContent에서 검색
post.rawContent.toLowerCase().includes(query)
```

---

## ✅ 체크리스트

- [x] 빌드 스크립트 수정
- [x] 프론트엔드 데이터 로더 수정
- [x] 타입 정의 업데이트
- [x] UI 컴포넌트 개선
- [x] 카테고리 설정 추가
- [x] 빌드 테스트 완료

---

## 🚨 주의사항

1. **카테고리 ID 일치**: Front Matter의 `category`는 `CATEGORY_CONFIG`의 `id`와 일치해야 함
2. **파일명 규칙**: `YYYY-MM-DD-slug.md` 형식 권장
3. **캐시 초기화**: 데이터 구조 변경 후 브라우저 캐시 클리어 필요
4. **빌드 필수**: 포스트 추가/수정 후 반드시 `npm run build:posts` 실행

---

## 📖 참고

- `scripts/build-posts.js`: 빌드 로직
- `src/data/posts.ts`: 데이터 로딩 로직
- `src/types/post.ts`: 타입 정의
- `_posts/`: 마크다운 원본 파일

